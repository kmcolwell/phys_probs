function shuffle(e){for(var t,r,n=e.length;n;t=Math.floor(Math.random()*n),r=e[--n],e[n]=e[t],e[t]=r);return e}var activityIndicatorOff,activityIndicatorOn,allError,animateHoverShadows,animateLoad,bindClicks,bindCollapsors,bindCopyEvents,bindDismissalRemoval,bsAlert,buildArgs,buildQuery,byteCount,cancelAsyncOperation,checkFileVersion,cleanupToasts,copyText,d$,dateMonthToString,deEscape,decode64,deepJQuery,delay,delayPolymerBind,doCORSget,e,encode64,error1,fixTruncatedJson,foo,formatScientificNames,getElementHtml,getLocation,getMaxZ,getPosterFromSrc,goTo,interval,isArray,isBlank,isBool,isEmpty,isHovered,isJson,isNull,isNumber,jsonTo64,lightboxImages,loadJS,mapNewWindows,openLink,openTab,overlayOff,overlayOn,p$,post64,prepURI,randomInt,randomString,roundNumber,roundNumberSigfig,safariDialogHelper,startLoad,stopLoad,stopLoadError,toFloat,toInt,toObject,toastStatusMessage,uri,slice=[].slice,indexOf=[].indexOf||function(e){for(var t=0,r=this.length;t<r;t++)if(t in this&&this[t]===e)return t;return-1};try{(uri={}).o=$.url(),uri.urlString=uri.o.attr("protocol")+"://"+uri.o.attr("host")+uri.o.attr("directory"),uri.query=uri.o.attr("fragment")}catch(error1){e=error1,console.warn("PURL not installed!")}window.debounce_timer=null,null==window.adminParams&&(window.adminParams={}),null==window._kmphys&&(window._kmphys={}),isBool=function(t,r){if(null==r&&(r=!1),r)return"boolean"==typeof t;try{return"boolean"==typeof t?!0===t||!1===t:"string"==typeof t?"true"===t.toLowerCase()||"false"===t.toLowerCase():"number"==typeof t&&(1===t||0===t)}catch(t){return e=t,!1}},isEmpty=function(e){return!e||0===e.length},isBlank=function(e){return!e||/^\s*$/.test(e)},isNull=function(t,r){var n;if(null==r&&(r=!1),"object"==typeof t)try{if(null!=(n=t.length))try{return 0===n}catch(e){}return 0===Object.size}catch(e){}try{if(isEmpty(t)||isBlank(t)||null==t){if(!1!==t&&0!==t)return!0;if(r&&(!1===t||0===t))return!0}}catch(t){return e=t,!1}try{t=(""+t).toLowerCase()}catch(e){}return"undefined"===t||"null"===t||!(!r||"false"!==t&&"0"!==t)},isJson=function(e){if("object"==typeof e&&!isArray(e))return!0;try{return JSON.parse(e),!0}catch(e){return!1}return!1},isArray=function(e){try{return e.slice(0).push("foo"),!0}catch(e){return!1}},isNumber=function(e){return!isNaN(parseFloat(e))&&isFinite(e)},toFloat=function(e){return!isNumber(e)||isNull(e)?0:parseFloat(e)},toInt=function(e){var t;return"string"==typeof e&&(e=e.replace("px","").replace("em","").replace("rem","").replace("vw","").replace("vh","")),!isNumber(e)||isNull(e)?0:(t=parseFloat(e),parseInt(t))},String.prototype.toAscii=function(){return this.replace(/[\u2018\u2019\u201A\u201B\u2032\u2035]/g,"'").replace(/[\u201C\u201D\u201E\u201F\u2033\u2036]/g,'"').replace(/[\u2013\u2014]/g,"-").replace(/[\u2026]/g,"...").replace(/\u02C6/g,"^").replace(/\u2039/g,"").replace(/[\u02DC|\u00A0]/g," ")},String.prototype.toBool=function(){var e;return"true"===(e=(""+this).toLowerCase())||"1"===e},Boolean.prototype.toBool=function(){return""+this=="true"},Number.prototype.toBool=function(){return""+this=="1"},String.prototype.addSlashes=function(){return this.replace(/[\\"']/g,"\\$&").replace(/\u0000/g,"\\0")},Array.prototype.max=function(){return Math.max.apply(null,this)},Array.prototype.min=function(){return Math.min.apply(null,this)},Array.prototype.containsObject=function(t){try{return"object"==typeof _.find(this,function(e){return _.isEqual(t,e)})}catch(t){return e=t,console.error("Please load underscore.js before using this."),console.info("https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.8.3/underscore-min.js")}},Object.toArray=function(e){try{return e.slice(0).push("foo"),e}catch(e){}return Object.keys(e).map(function(t){return e[t]})},Object.size=function(t){var r,n;if("object"!=typeof t)try{return t.length}catch(t){e=t,console.error("Passed argument isn't an object and doesn't have a .length parameter"),console.warn(e.message)}n=0;for(r in t)t.hasOwnProperty(r)&&n++;return n},Object.doOnSortedKeys=function(e,t){var r,n,o,a,i;for(a=[],n=0,o=(i=Object.keys(e).sort()).length;n<o;n++)r=e[i[n]],a.push(t(r));return a},delay=function(e,t){return setTimeout(t,e)},interval=function(e,t){return setInterval(t,e)},roundNumber=function(e,t){var r;return null==t&&(t=0),r=Math.pow(10,t),Math.round(e*r)/r},roundNumberSigfig=function(e,t){var r,n,o,a,i;return null==t&&(t=0),o=""+roundNumber(e,t),1===(r=o.split(".")).length?o+"."+Array(t+1).join("0"):(i=r.pop(),a=r[0]+".",i.length===t?o:(n=t-i.length,i+=Array(n+1).join("0"),""+a+i))},String.prototype.stripHtml=function(e){var t;return null==e&&(e=!1),t=this,e&&(t=t.replace(/<(\w+)(?:[^"'>]|"[^"]*"|'[^']*')*>(?:((?:.)*?))<\/?\1(?:[^"'>]|"[^"]*"|'[^']*')*>/gm,"")),t=t.replace(/<script[^>]*>([\S\s]*?)<\/script>/gim,""),t=t.replace(/<\/?\w(?:[^"'>]|"[^"]*"|'[^']*')*>/gim,"")},String.prototype.unescape=function(e){var t,r,n;return null==e&&(e=!1),r=document.createElement("div"),t=function(t){return null!=t&&"string"==typeof t&&(t=!0!==e?escape(t).replace(/%26/g,"&").replace(/%23/g,"#").replace(/%3B/g,";"):(t=t.replace(/<script[^>]*>([\S\s]*?)<\/script>/gim,"")).replace(/<\/?\w(?:[^"'>]|"[^"]*"|'[^']*')*>/gim,""),r.innerHTML=t,r.innerText?(t=r.innerText,r.innerText=""):(t=r.textContent,r.textContent="")),unescape(t)},n=deEscape(this),t(n)},deEscape=function(e){return e=e.replace(/\&amp;#/gm,"&#"),e=e.replace(/\&quot;/gm,'"'),e=e.replace(/\&quote;/gm,'"'),e=e.replace(/\&#95;/gm,"_"),e=e.replace(/\&#39;/gm,"'"),e=e.replace(/\&#34;/gm,'"'),e=e.replace(/\&#62;/gm,">"),e=e.replace(/\&#60;/gm,"<")},String.prototype.escapeQuotes=function(){var e;return e=this.replace(/"/gm,"&#34;"),e=e.replace(/'/gm,"&#39;")},getElementHtml=function(e){return e.outerHTML},jQuery.fn.outerHTML=function(){return(e=$(this).get(0)).outerHTML},jQuery.fn.outerHtml=function(){return $(this).outerHTML()},buildArgs=buildQuery=function(e){var t,r,n,o,a;n=[];for(t in e)o=e[t],r=t.replace(/[^A-Za-z\-_\[\]]/gim,""),a=encodeURIComponent(o).replace(/\%20/g,"+"),n.push(r+"="+a);return n.join("&")},jQuery.fn.selectText=function(){var e,t,r=document,n=this[0];r.body.createTextRange?((e=document.body.createTextRange()).moveToElementText(n),e.select()):window.getSelection&&(t=window.getSelection(),(e=document.createRange()).selectNodeContents(n),t.removeAllRanges(),t.addRange(e))},copyText=function(e,t,r){var n,o,a,i;if(null==window.copyDebouncer&&(window.copyDebouncer={}),Date.now()-window.copyDebouncer.last<300)return console.warn("Skipping copy on debounce"),!1;window.copyDebouncer.last=Date.now(),a=md5($(r).html());try{return o={dataType:"text/plain",data:e},n=new ClipboardEvent("copy",o),document.dispatchEvent(n),!1}catch(e){}return null!=(null!=(i=_kmphys.copyObject)?i[a]:void 0)?(o={"text/plain":e},console.info('Setting up clipboard events for "'+e+'"'),_kmphys.copyObject[a].setData(o),_kmphys.copyObject[a].on("copy",function(e){try{return e.clipboardData={setData:_kmphys.copyObject[a].setData(o)}}catch(e){}}),_kmphys.copyObject[a].on("aftercopy",function(t){return t.data["text/plain"]===e?(toastStatusMessage("Copied to clipboard"),console.info("Succesfully copied",t.data["text/plain"]),window.hasRetriedCopy=!1):t.data["text/plain"]?(console.warn("Incorrect copy: instead of '"+e+"', '"+t.data["text/plain"]+"'"),window.hasRetriedCopy?(console.error("Re-copy failed!"),toastStatusMessage("Error copying to clipboard. Please try again")):(window.hasRetriedCopy=!0,delete window.copyDebouncer.last,delay(100,function(){return console.warn("Re-trying copy"),$(r).click(),console.info("Sent click")}))):(console.error("Bad data passed",t.data["text/plain"]),toastStatusMessage("Error copying to clipboard. Please try again"),window.hasRetriedCopy=!1),window.resetClipboard=!1,_kmphys.copyObject[a].setData(o)}),_kmphys.copyObject[a].on("error",function(t){if(console.error("Error copying to clipboard"),console.warn("Got",t),"flash-overdue"===t.name){if(!0===window.resetClipboard)return console.error("Resetting ZeroClipboard didn't work!"),!1;ZeroClipboard.on("ready",function(){return window.resetClipboard=!0,copyLink(window.tempZC,e)}),window.tempZC=new ZeroClipboard(r)}if("flash-disabled"===t.name)return console.info("No flash on this system"),ZeroClipboard.destroy(),$(".click-copy").remove(),p$("paper-dialog").refit(),toastStatusMessage("Clipboard copying isn't available on your system")})):console.error("Can't copy: zcObject doesn't exist for identifier "+a),!1},bindCopyEvents=function(e){return null==e&&(e=".click-copy"),loadJS("bower_components/zeroclipboard/dist/ZeroClipboard.min.js",function(){var t,r,n,o,a,i,l,s,c;for(c={swfPath:"bower_components/zeroclipboard/dist/ZeroClipboard.swf"},ZeroClipboard.config(c),l=[],o=0,a=(i=$(e)).length;o<a;o++)if(r=i[o],n=md5($(r).html()),null==_kmphys.copyObject&&(_kmphys.copyObject={}),null==_kmphys.copyObject[n]){if(console.info("Setting up copy events for identifier",n),_kmphys.copyObject[n]=new ZeroClipboard(r),s=$(r).attr("data-clipboard-text"),isNull(s)&&(t=$(r).attr("data-copy-selector"),s=$(t).val(),isNull(s)))try{s=p$(t).value}catch(e){}console.info("Registering copy text",s);try{delete window.copyDebouncer.last}catch(e){}l.push(copyText(s,_kmphys.copyObject[n],r))}else l.push(console.info("Copy event already set up for identifier",n));return l}),!1},buildQuery=function(e){var t,r,n,o,a;n=[];for(t in e)o=e[t],r=t.replace(/[^A-Za-z\-_\[\]]/gim,""),a=encodeURIComponent(o).replace(/\%20/g,"+"),n.push(r+"="+a);return n.join("&")},jsonTo64=function(e,t){var r,n;null==t&&(t=!0);try{e.slice(0).push("foo"),e=toObject(e)}catch(e){}return n=JSON.stringify(e),r=!0===t?post64(n):encode64(r)},encode64=function(t){try{return Base64.encode(t)}catch(r){return e=r,console.warn("Bad encode string provided"),t}},decode64=function(t){try{return Base64.decode(t)}catch(r){return e=r,console.warn("Bad decode string provided"),t}},post64=function(e){var t;return t=encode64(e),encodeURIComponent(t)},jQuery.fn.polymerSelected=function(t,r){var n,o,a;if(null==t&&(t=void 0),null==r&&(r="attrForSelected"),n=$(this).attr(r),null==t){a=void 0;try{a=$(this).get(0).selected,isNumber(a)&&!isNull(n)&&(o=$(this).find("paper-item")[toInt(a)],a=$(o).attr(n))}catch(t){return e=t,!1}return"null"!==a&&null!=a||(a=void 0),a}if(isBool(t)){if($(this).parent().children().removeAttribute("aria-selected"),$(this).parent().children().removeAttribute("active"),$(this).parent().children().removeClass("iron-selected"),$(this).prop("selected",t),$(this).prop("active",t),$(this).prop("aria-selected",t),!0===t)return $(this).addClass("iron-selected")}else try{return $(this).get(0).select(t)}catch(t){return e=t,!1}},jQuery.fn.polymerChecked=function(e){var t;return null==e&&(e=void 0),null!=e?jQuery(this).prop("checked",e):("null"!==(t=jQuery(this)[0].checked)&&null!=t||(t=void 0),t)},isHovered=function(e){return $(e+":hover").length>0},jQuery.fn.exists=function(){return jQuery(this).length>0},jQuery.fn.isVisible=function(){return jQuery(this).is(":visible")&&"hidden"!==jQuery(this).css("visibility")},jQuery.fn.hasChildren=function(){return Object.size(jQuery(this).children())>3},byteCount=function(e){return encodeURI(e).split(/%..|./).length-1},toObject=function(e){var t,r,n;n={};for(r in e)void 0!==(t=e[r])&&(n[r]=t);return n},loadJS=function(t,r,n){var o,a,i;if(null==r&&(r={}),null==n&&(n=!0),$("script[src='"+t+"']").exists()){if("function"==typeof r)try{r()}catch(t){e=t,console.error("Script is already loaded, but there was an error executing the callback function - "+e.message)}return!0}return(i=document.createElement("script")).setAttribute("src",t),i.setAttribute("async","async"),i.setAttribute("type","text/javascript"),i.src=t,i.async=!0,a=function(){var n;n=i.readyState;try{if(!r.done&&(!n||/loaded|complete/.test(n))&&(r.done=!0,"function"==typeof r))try{return r()}catch(r){return e=r,console.error("Postload callback error for "+t+" - "+e.message),console.warn(e.stack)}}catch(t){return e=t,console.error("Onload error - "+e.message)}},o=function(){console.warn("There may have been a problem loading "+t);try{if(!r.done&&(r.done=!0,"function"==typeof r&&n))try{return r()}catch(t){return e=t,console.error("Post error callback error - "+e.message)}}catch(t){return e=t,console.error("There was an error in the error handler! "+e.message)}},i.setAttribute("onload",a),i.setAttribute("onreadystate",a),i.setAttribute("onerror",o),i.onload=i.onreadystate=a,i.onerror=o,document.getElementsByTagName("head")[0].appendChild(i),!0},String.prototype.toTitleCase=function(){var e,t,r,n,o,a,i,l;for(o=this.replace(/([^\W_]+[^\s-]*) */g,function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()}),r=["A","An","The","And","But","Or","For","Nor","As","At","By","For","From","In","Into","Near","Of","On","Onto","To","With"],e=0,21;e<21;e++)t=RegExp("\\s"+r[e]+"\\s","g"),o=o.replace(t,function(e){return e.toLowerCase()});for(l=["Id","Tv"],n=0,2;n<2;n++)i=RegExp("\\b"+(a=l[n])+"\\b","g"),o=o.replace(i,a.toUpperCase());return o},Function.prototype.getName=function(){var e;return null==(e=this.name)&&(e=(""+this).substr(0,(""+this).indexOf("(")).replace("function ","")),isNull(e)&&(e=md5(""+this)),e},Function.prototype.debounce=function(){var t,r,n,o,a,i,l,s;l=arguments[0],n=arguments[1],s=arguments[2],t=4<=arguments.length?slice.call(arguments,3):[],null==l&&(l=300),null==n&&(n=!1),null==s&&(s=window.debounce_timer),null==(null!=(i=window.core)?i.debouncers:void 0)&&(null==window.core&&(window.core={}),core.debouncers={});try{a=this.getName()}catch(e){}try{null!=core.debouncers[a]&&(s=core.debouncers[a])}catch(e){}if(o=this,r=function(){if(null!=a&&(clearTimeout(s),delete core.debouncers[a]),!n)return o.apply(o,t)},null!=s)try{clearTimeout(s)}catch(t){e=t}return n?(o.apply(obj,t),console.log("Executed "+a+" immediately"),!1):null!=a?core.debouncers[a]=delay(l,function(){return r()}):(console.log("Delaying '"+a+"' for "+l+" ms"),window.debounce_timer=delay(l,function(){return r()}))},randomInt=function(e,t){var r,n,o;return null==e&&(e=0),null==t&&(t=1),o=Math.random(),null==e&&(e=(r=[0,e])[0],t=r[1]),e>t&&(e=(n=[t,e])[0],t=n[1]),Math.floor(o*(t-e+1)+e)},randomString=function(e){var t,r,n;for(null==e&&(e=8),r=0,65,126,n=[];r<e;)++r,t=randomInt(65,126),n.push(String.fromCharCode(t));return n.join("")},startLoad=animateLoad=function(t){var r;null==t&&(t="loader"),isNumber(t)&&(t="loader"),"#"===t.slice(0,1)?(r=t,t=t.slice(1)):r="#"+t;try{return $(r).exists()?$(r).attr("active",!0):$("body").append('<paper-spinner id="'+t+'" active></paper-spinner'),!1}catch(t){return e=t,console.log("Could not animate loader",e.message)}},stopLoad=function(t,r){var n;null==t&&(t="loader"),null==r&&(r=1e3),"#"===t.slice(0,1)?(n=t,t=t.slice(1)):n="#"+t;try{if($(n).exists())return $(n).addClass("good"),delay(r,function(){return $(n).removeClass("good"),$(n).removeAttr("active")})}catch(t){return e=t,console.log("Could not stop load animation",e.message)}},stopLoadError=function(t,r,n){var o;null==r&&(r="loader"),null==n&&(n=1e4),"#"===r.slice(0,1)?(o=r,r=r.slice(1)):o="#"+r;try{if($(o).exists())return $(o).addClass("bad"),null!=t&&toastStatusMessage(t,"",n),delay(n,function(){return $(o).removeClass("bad"),$(o).removeAttr("active")})}catch(t){return e=t,console.log("Could not stop load error animation",e.message)}},toastStatusMessage=function(e,t,r,n){var o,a,i;if(null==t&&(t=""),null==r&&(r=3e3),null==n&&(n="#status-message"),null==(null!=(a=window.metaTracker)?a.isToasting:void 0)&&null==window.metaTracker&&(window.metaTracker={},window.metaTracker.toastTracker=[],window.metaTracker.isToasting=!1),window.metaTracker.isToasting)return i=delay(250,function(){return toastStatusMessage(e,t,r,n)}),window.metaTracker.toastTracker.push(i),!1;window.metaTracker.isToasting=!0,isNumber(r)||(r=3e3),!1===n.slice(0,1)&&(n="#"+n),$(n).exists()||(o='<paper-toast id="'+n.slice(1)+'" duration="'+r+'"></paper-toast>',$(o).appendTo("body")),$(n).attr("text",e).html(e).addClass(t);try{p$(n).show()}catch(e){}return delay(r+500,function(){var e;try{e=p$(n).opened}catch(t){e=!1}return e||($(n).empty(),$(n).removeClass(t),$(n).attr("text","")),window.metaTracker.isToasting=!1})},cleanupToasts=function(){var e,t,r,n,o;for(n=[],e=0,t=(r=window.metaTracker.toastTracker).length;e<t;e++){o=r[e];try{n.push(clearTimeout(o))}catch(e){}}return n},openLink=function(e){return null!=e&&(window.open(e),!1)},openTab=function(e){return openLink(e)},goTo=function(e){return null!=e&&(window.location.href=e,!1)},mapNewWindows=function(e){var t,r,n;for(null==e&&(e=!0),n=[".newwindow",".newWindow",".new-window","[newwindow]","[new-window]"],t=0,5;t<5;t++)r=n[t],$(r).each(function(){var t;return null==(t=$(this).attr("href"))&&(t=$(this).attr("data-href")),$(this).click(function(r){return e&&(r.preventDefault(),r.stopPropagation()),openTab(t)}),$(this).keypress(function(){return openTab(t)})});return!1},deepJQuery=function(t){"undefined"!=typeof jQuery&&null!==jQuery||console.warn("Danger -- jQuery isn't defined. Selectors may fail.");try{if(!$("html /deep/ "+t).exists())throw"Bad /deep/ selector";return $("html /deep/ "+t)}catch(r){e=r;try{if(!$("html >>> "+t).exists())throw"Bad >>> selector";return $("html >>> "+t)}catch(r){return e=r,$(p$(t))}}},d$=function(e){return deepJQuery(e)},bindClicks=function(t){null==t&&(t=".click"),$(t).each(function(){var t,r,n,o,a,i,l,s;try{if(s=null!=(n=$(this).attr("data-href"))?n:$(this).attr("href"),!isNull(s)){try{l=$(this).prop("tagName").toLowerCase()}catch(e){l=null}try{s===uri.o.attr("path")&&"paper-tab"===l&&$(this).parent().prop("selected",$(this).index())}catch(t){e=t,console.warn("tagname lower case error")}return r=(null!=(o=$(this).attr("newTab"))?o.toBool():void 0)||(null!=(a=$(this).attr("newtab"))?a.toBool():void 0)||(null!=(i=$(this).attr("data-newtab"))?i.toBool():void 0),"a"!==l||r?("a"===l&&$(this).keypress(function(){return openTab(s)}),$(this).unbind().click(function(e){e.preventDefault(),e.stopPropagation();try{return r?openTab(s):goTo(s)}catch(e){return goTo(s)}}),s):!0}if(null!=(t=$(this).attr("data-function")))return $(this).unbind(),$(this).click(function(){var r;try{console.log("Executing bound function "+t+"()");try{r=null,isNull($(this).attr("data-args"))||(r=$(this).attr("data-args").split(","))}catch(e){}try{return null!=r?window[t].apply(window,r):window[t]()}catch(e){return window[t]()}}catch(r){return e=r,console.error("'"+t+"()' is a bad function - "+e.message)}})}catch(t){return e=t,console.error("There was a problem binding to #"+$(this).attr("id")+" - "+e.message)}});try{bindCollapsors()}catch(e){}return!1},bindCollapsors=function(e){var t,r,n,o,a;for(null==e&&(e=".collapse-trigger"),a=function(e){var t,r,n;return r=$(e).attr("data-target"),$(r).exists()?(n=["iron-collapse"],t=p$(r).tagName.toLowerCase(),indexOf.call(n,t)>=0?p$(r).toggle():console.error("Target type "+p$(r).tagName.toLowerCase()+" is an invalid target"),!1):(console.error("Couldn't find target "+r),!1)},t=0,r=(n=$(e)).length;t<r;t++)o=n[t],$(o).click(function(){return a.debounce(50,null,null,this)});return!1},dateMonthToString=function(e){var t,r;t={0:"January",1:"February",2:"March",3:"April",4:"May",5:"June",6:"July",7:"August",8:"September",9:"October",10:"November",11:"December"};try{r=t[e]}catch(t){r=e}return r},getPosterFromSrc=function(t){var r;try{return r=t.split("."),r.pop(),r.push("png"),r.join(".")}catch(t){return e=t,""}},doCORSget=function(t,r,n,o){var a,i,l,s;null==n&&(n=void 0),null==o&&(o=void 0),a=function(){if("function"==typeof o)return o();throw Error("There was an error performing the CORS request")},l={url:t,data:r,type:"get",crossDomain:!0};try{$.ajax(l).done(function(e){return"function"==typeof n?(n(),!1):console.log(response)}).fail(function(e,t){return console.warn("Couldn't perform jQuery AJAX CORS. Attempting manually.")})}catch(t){e=t,console.warn("There was an error using jQuery to perform the CORS request. Attemping manually.")}if(t=t+"?"+r,i=function(e,t){var r;return null==e&&(e="get"),"withCredentials"in(r=new XMLHttpRequest)?r.open(e,t,!0):"undefined"!=typeof XDomainRequest?(r=new XDomainRequest).open(e,t):r=null,r},!(s=i("get",t)))throw Error("CORS not supported");return s.onload=function(){var e;return e=s.responseText,"function"==typeof n&&n(e),console.log(e),!1},s.onerror=function(){return console.warn("Couldn't do manual XMLHttp CORS request"),a()},s.send(),!1},lightboxImages=function(t,r){var n,o;return null==t&&(t=".lightboximage"),null==r&&(r=!1),o={onStart:function(){return overlayOn()},onEnd:function(){return overlayOff(),activityIndicatorOff()},onLoadStart:function(){return activityIndicatorOn()},onLoadEnd:function(){return activityIndicatorOff()},allowedTypes:"png|jpg|jpeg|gif|bmp|webp",quitOnDocClick:!0,quitOnImgClick:!0},n=r?d$(t):$(t),loadJS("bower_components/imagelightbox/dist/imagelightbox.min.js",function(){return n.click(function(e){try{return e.preventDefault(),e.stopPropagation(),$(this).imageLightbox(o).startImageLightbox(),console.warn("Event propagation was stopped when clicking on this.")}catch(t){return e=t,console.error("Unable to lightbox this image!")}}).each(function(){var r,n;console.log("Using selectors '"+t+"' / '"+this+"' for lightboximages");try{if("img"===$(this).prop("tagName").toLowerCase()&&"a"!==$(this).parent().prop("tagName").toLowerCase())return n=$(this).removeClass("lightboximage").prop("outerHTML"),r=function(){switch(!1){case!!isNull($(this).attr("data-layzr-retina")):return $(this).attr("data-layzr-retina");case!!isNull($(this).attr("data-layzr")):return $(this).attr("data-layzr");case!!isNull($(this).attr("data-lightbox-image")):return $(this).attr("data-lightbox-image");default:return $(this).attr("src")}}.call(this),$(this).replaceWith("<a href='"+r+"' class='lightboximage'>"+n+"</a>"),$("a[href='"+r+"']").imageLightbox(o)}catch(t){return e=t,console.log("Couldn't parse through the elements")}}),console.info("Lightboxed the following:",n)})},activityIndicatorOn=function(){return $('<div id="imagelightbox-loading"><div></div></div>').appendTo("body")},activityIndicatorOff=function(){return $("#imagelightbox-loading").remove(),$("#imagelightbox-overlay").click(function(){return $("#imagelightbox").click()})},overlayOn=function(){return $('<div id="imagelightbox-overlay"></div>').appendTo("body")},overlayOff=function(){return $("#imagelightbox-overlay").remove()},formatScientificNames=function(e){return null==e&&(e=".sciname"),$(".sciname").each(function(){var e,t,r;if(t="italic"===$(this).css("font-style")?"normal":"italic",$(this).css("font-style",t),e=$(this).find(".genus").text(),r=$(this).find(".species").text(),!isNull(e)&&!isNull(r))return $(this).unbind().addClass("sciname-click").click(function(){var t;return t=uri.urlString+"dashboard.php?taxon="+e+"+"+r,goTo(t),!1})})},prepURI=function(e){return(e=encodeURIComponent(e)).replace(/%20/g,"+")},window.locationData={},locationData.params={enableHighAccuracy:!0},locationData.last=void 0,getLocation=function(e){var t,r;return null==e&&(e=void 0),1500,r=function(t){var r;return clearTimeout(window.geoTimeout),window.locationData.lat=t.coords.latitude,window.locationData.lng=t.coords.longitude,window.locationData.acc=t.coords.accuracy,r=window.locationData.last,window.locationData.last=Date.now(),!(window.locationData.last-r<1500)&&(console.info("Successfully set location"),"function"==typeof e&&e(window.locationData),!1)},t=function(t){var r;return clearTimeout(window.geoTimeout),r=function(){switch(t.code){case 0:return"There was an error while retrieving your location: "+t.message;case 1:return"The user prevented this page from retrieving a location";case 2:return"The browser was unable to determine your location: "+t.message;case 3:return"The browser timed out retrieving your location."}}(),console.error(r),"function"==typeof e&&e(!1),!1},navigator.geolocation?(console.log("Querying location"),navigator.geolocation.getCurrentPosition(r,t,window.locationData.params),window.geoTimeout=delay(1500,function(){return getLocation(e)})):(console.warn("This browser doesn't support geolocation!"),null!=e?e(!1):void 0)},getMaxZ=function(){var e;return e=function(){return $.map($("body *"),function(e,t){if("static"!==$(e).css("position"))return parseInt($(e).css("z-index")||1)})},Math.max.apply(null,e())},foo=function(){return toastStatusMessage("Sorry, this feature is not yet finished"),stopLoad(),!1},safariDialogHelper=function(t,r,n){var o,a;if(null==t&&(t="#download-chooser"),null==r&&(r=0),"function"!=typeof n&&(n=function(){return bindDismissalRemoval()}),!(r<10))return stopLoadError("Unable to show dialog. Please try again.");try{return d$(t).get(0).open(),delay(125,function(){return d$(t).get(0).refit()}),"function"==typeof n&&n(),stopLoad()}catch(i){return e=i,a=r+1,o=250,delay(o,function(){return console.warn("Trying again to display dialog after "+a*o+"ms"),safariDialogHelper(t,a,n)})}},bindDismissalRemoval=function(){return $("[dialog-dismiss]").unbind().click(function(){return $(this).parents("paper-dialog").remove()})},p$=function(e){try{return $$(e)[0]}catch(t){return $(e).get(0)}},bsAlert=function(e,t,r,n){var o,a;return null==t&&(t="warning"),null==r&&(r="body"),null==n&&(n="#bs-alert"),$(n).exists()?($(n).removeClass("alert-warning alert-info alert-danger alert-success"),$(n).addClass("alert-"+t)):(o='<div class="alert alert-'+t+' alert-dismissable hanging-alert" role="alert" id="'+n.slice(1)+'">\n  <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>\n    <div class="alert-message"></div>\n</div>',a=$("main").exists()?"main":$("article").exists()?"article":r,$(a).prepend(o)),$(n+" .alert-message").html(e),bindClicks(),mapNewWindows(),!1},animateHoverShadows=function(e,t,r){var n,o;return null==e&&(e="paper-card.card-tile"),null==t&&(t=2),null==r&&(r=4),n=function(){return $(this).attr("elevation",r)},o=function(){return $(this).attr("elevation",t)},$(e).hover(n,o),!1},allError=function(e){return stopLoadError(e),bsAlert(e,"danger"),console.error(e),!1},checkFileVersion=function(e,t,r){var n,o,a;null==e&&(e=!1),null==t&&(t="js/c.min.js"),null==("undefined"!=typeof _kmphys&&null!==_kmphys?_kmphys.lastModChecked:void 0)&&(null==window._kmphys&&(window._kmphys={}),window._kmphys.lastModChecked={}),o=t.split("/").pop().split(".")[0],n=function(a,i){return null==a&&(a=t),null==i&&(i=o),$.get(uri.urlString+"meta.php","do=get_last_mod&file="+a,"json").done(function(t){var r;return window._kmphys.lastModChecked[i]=Date.now(),e&&doNothing(),!!isNumber(t.last_mod)&&(null==_kmphys.lastMod&&(window._kmphys.lastMod={}),null==_kmphys.lastMod[i]&&(window._kmphys.lastMod[i]=t.last_mod),t.last_mod>_kmphys.lastMod[i]?(r='<div id="outdated-warning" class="alert alert-warning alert-dismissible fade in" role="alert">\n  <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>\n  <strong>We have page updates!</strong> This page has been updated since you last refreshed. <a class="alert-link" id="refresh-page" style="cursor:pointer">Click here to refresh now</a> and get bugfixes and updates.\n</div>',$("#outdated-warning").exists()||($("body").append(r),$("#refresh-page").click(function(){return document.location.reload(!0)})),console.warn("Your current version of this page is out of date! Please refresh the page.")):e?doNothing():void 0)}).fail(function(){return console.warn("Couldn't check file version!!")}).always(function(){if(delay(3e5,function(){return n(a,i)}),"function"==typeof r)return r()})};try{a=window._kmphys.lastMod[o]}catch(e){a=!1}if(e||null==window._kmphys.lastMod||!a){try{Date.now()-toInt(window._kmphys.lastModChecked[o])<15e3||n(t,o)}catch(e){n(t,o)}return!0}return!1},window.checkFileVersion=checkFileVersion,fixTruncatedJson=function(e){var t,r,n,o,a;for(t=r=e,o=!1,n=!1,a=[];n=t.match(/[^\{\[\]\}"]*([\{\[\]\}"])/);){switch(n[1]){case"{":a.push("}");break;case"[":a.push("]");break;case"}":case"]":a.pop();break;case'"':o?(o=!1,a.pop()):(o=!0,a.push('"'))}t=t.substring(n[0].length)}for(":"===t[t.length-1]&&(r+='""');a.length;)r+=a.pop();try{return JSON.parse(r)}catch(e){return!1}},cancelAsyncOperation=function(e,t){null==t&&(t=_kmphys.currentAsyncJqxhr);try{null!=e&&$(e).remove()}catch(e){}try{if(t.readyState===XMLHttpRequest.DONE)return console.warn("Couldn't cancel operation -- it's already completed"),!1;t.abort();try{stopLoadBarsError(null,"Operation Cancelled")}catch(e){stopLoadError("Operation Cancelled")}}catch(e){console.error("Couldn't abort current async operation")}return!1},delayPolymerBind=function(t,r,n){var o,a,i;if(null==n&&(n=0),"object"!=typeof window._dpb&&(window._dpb={}),i=md5(t)+md5(r),isNull(window._dpb[i])&&(window._dpb[i]=!1),1e3,null!=("undefined"!=typeof Polymer&&null!==Polymer&&null!=(a=Polymer.Base)?a.$$:void 0)){!1===window._dpb[i]&&(n=0,window._dpb[i]=!0);try{o=Polymer.Base.$$(t),r(o),delay(1e3,function(){return console.info("Doing 1000ms delay callback for "+t),r(o)})}catch(a){e=a,console.warn("Error trying to do the delayed polymer bind - "+e.message),n<10?(++n,delay(75,function(){return delayPolymerBind(t,r,n)})):(console.error("Persistent error in polymer binding ("+e.message+")"),console.error(e.stack),o=$(t).get(0),r(o),delay(1e3,function(){return o=document.querySelector(t),console.info("Doing 1000ms delay callback for "+t),console.info("Using element",o),r(o)}))}}else n<50?delay(100,function(){return++n,delayPolymerBind(t,r,n)}):(console.error("Failed to verify Polymer was set up, attempting manual"),o=document.querySelector(t),r(o));return!1},$(function(){bindClicks(),formatScientificNames(),lightboxImages(),animateHoverShadows(),checkFileVersion();try{$(".do-mailto").click(function(){var e;return e=$(this).attr("data-email"),document.location.href="mailto:"+e,!1})}catch(e){}try{$("body").tooltip({selector:"[data-toggle='tooltip']"})}catch(t){e=t,console.warn("Tooltips were attempted to be set up, but do not exist")}return loadJS(uri.urlString+"js/prism.js")}),$(function(){return!1});
//# sourceMappingURL=c.min.js.map